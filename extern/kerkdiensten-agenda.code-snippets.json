{"generator":"Code Snippets v3.5.0","date_created":"2023-10-10 19:28","snippets":[{"id":6,"name":"Kerkdiensten agenda","desc":"<p>Deze snippet maakt verbinding met de database achter het intranet om de gegevens van de laatste 3 diensten op te vragen en deze in HTML terug te geven.<\/p>","code":"<?php\ndate_default_timezone_set('Europe\/Amsterdam');\n\ninclude_once('intranet\/include\/config_db.php');\n\n# Variabelen definieren\n$TableDiensten\t\t= \"kerkdiensten\";\n$DienstID\t\t\t= \"id\";\n$DienstStart\t\t= \"start\";\n$DienstEind\t\t\t= \"eind\";\n$DienstVoorganger\t= \"voorganger\";\n$DienstOpmerking\t= \"opmerking\";\n\n$TableVoorganger \t= \"predikanten\";\n$VoorgangerID \t\t= \"id\";\n$VoorgangerTitel \t= \"titel\";\n$VoorgangerInit \t= \"initialen\";\n$VoorgangerTussen \t= \"tussen\";\n$VoorgangerAchter \t= \"achternaam\";\n$VoorgangerPlaats \t= \"plaats\";\n\n# Verbinding maken met de database\n$db = mysqli_connect($dbHostname, $dbUsername, $dbPassword, $dbName) or die(\"Error \" . mysqli_error($db));\nmysqli_set_charset($db, 'utf8mb4');\n\n# Eerstvolgende 3 diensten opvragen\n$sql_dienst = \"SELECT * FROM $TableDiensten WHERE $DienstEind > \". time() .\" ORDER BY $DienstEind ASC LIMIT 0,3\";\n$result_dienst = mysqli_query($db, $sql_dienst);\n\nif($row_dienst = mysqli_fetch_array($result_dienst)) {\t\t\n\techo \"<div class='row'>\";\n\t\n\tdo {\t\t\n\t\t$dag\t\t\t\t= date('d', $row_dienst[$DienstStart]);\n\t\t$maand\t\t\t= date('M', $row_dienst[$DienstStart]);\n\t\t$begintijd\t=\tdate('H:i', $row_dienst[$DienstStart]);\n\t\t$eindtijd\t\t=\tdate('H:i', $row_dienst[$DienstEind]);\t\t\n\t\t$locatie\t\t= 'Koningskerk Deventer';\n\t\t$bijzonderheid\t= $row_dienst[$DienstOpmerking];\n\t\t\n\t\tif(date(\"H\",$row_dienst[$DienstStart]) < 12) {\n\t\t\t$titel = 'Ochtenddienst';\n\t\t} elseif(date(\"H\", $row_dienst[$DienstStart]) < 18) {\n\t\t\t$titel = 'Middagdienst';\n\t\t} else {\n\t\t\t$titel = 'Avonddienst';\n\t\t}\n\t\t\n\t\t# Als er een voorganger bekend is, vraag de details op\n\t\tif($row_dienst[$DienstVoorganger] > 0) {\n\t\t\t$sql_voorganger = \"SELECT * FROM $TableVoorganger WHERE $VoorgangerID = \". $row_dienst[$DienstVoorganger];\n\t\t\t$result_voorganger = mysqli_query($db, $sql_voorganger);\n\t\t\t$row_voorganger = mysqli_fetch_array($result_voorganger);\n\t\t\t\n\t\t\t$voorganger_naam\t= strtolower($row_voorganger[$VoorgangerTitel]).' '.$row_voorganger[$VoorgangerInit].' '.($row_voorganger[$VoorgangerTussen] == '' ? '' : $row_voorganger[$VoorgangerTussen].' ').$row_voorganger[$VoorgangerAchter];\n\t\t\tif(strtolower($row_voorganger[$VoorgangerPlaats]) != 'deventer' AND $row_voorganger[$VoorgangerPlaats] != '') {\n\t\t\t\t$voorganger_naam .= ' ('.$row_voorganger[$VoorgangerPlaats].')';\n\t\t\t}\t\n\t\t\t\t\t\t\n\t\t\t$titel = $titel .' '. trim($voorganger_naam);\n\t\t}\n\t\t\t\t\n\t\t# Samenkomst\n\t\techo \"<div class='col-md-4 col-sm-4'>\\n\";\n\t\techo \"\t<article class='mec-past-event mec-event-article mec-clear' itemscope=''>\\n\";\n\t\techo \"\t<div class='mec-event-date mec-bg-color-hover mec-border-color-hover mec-color'>\\n\";\n\t\techo \"\t\t<span>$dag<\/span>$maand<\/div>\\n\";\n\t\techo \"\t<div class='event-detail-wrap'>\\n\";\n\t\techo \"\t\t<h4 class='mec-event-title'>$titel\". ($bijzonderheid != '' ? \"<span class='mec-repeating-label'>$bijzonderheid<\/span>\" : '') .\"\\n\";\n\t\t#echo \"<a class='mec-color-hover' data-event-id='48176' href='https:\/\/www.koningskerkdeventer.nl\/events\/samenkomst-koningskerk-deventer\/' target='_self' rel='noopener'>Samenkomst<\/a>\";\n\t\techo \"\t\t<span class='event-color' style='background: #8224e3'>\\n\";\n\t\techo \"\t\t<\/span>\\n\";\n\t\techo \"\t\t<\/h4>\\n\";\n\t\techo \"\t\t<div class='mec-time-details'>\\n\";\n\t\techo \"\t\t\t<span class='mec-start-time'>$begintijd<\/span> - <span class='mec-end-time'>$eindtijd<\/span>\\n\";\n\t\techo \"\t\t<\/div>\\n\";\n\t\techo \"\t\t<div class='mec-event-detail'>\\n\";\n\t\techo \"\t\t\t<div class='mec-event-loc-place'>$locatie<\/div>\\n\";\n\t\techo \"\t\t<\/div>\\n\";\n\t\techo \"\t<\/div>\\n\";\n\t\techo \"\t<\/article>\\n\";\n\t\techo \"<\/div>\\n\";\n\t} while($row_dienst = mysqli_fetch_array($result_dienst));\n\techo \"<\/div>\\n\";\n}\n\n?>","tags":["kerkdienst","agenda","intranet"],"scope":"content","active":true,"modified":"2023-10-08 13:34:51","revision":"60"}]}